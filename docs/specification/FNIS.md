# FNIS MD(Motion Driven) & RD(Rotation) Specification

- Memo: Visual Basic comments use single quotes (') like FNIS lists. Therefore, vb is reused in code blocks.

## MD(Motion Driven): Translation Data

- Example:

```vb
' format: time x y z

MD 1.5 0 -150 -150 ' ← time=1.5, x=0, y=-150, z=-150
MD 1.5 0 -150 -600 ' ← time=1.5, x=0, y=-150, z=-600
MD 1.5 0 -150 0    ' ← time=1.5, x=0, y=-150, z=0
MD 1.5 0 -150 0    ' ← time=1.5, x=0, y=-150, z=0
```

- animationdatasinglefile.txt FNIS Output:

```vb
1657                      ' ← clip_id (auto generated by tool)
1.5                       ' ← duration (seconds)
1                         ' ← translation_len
1.5 0 -150 0              ' ← translation: time=1.5, x=0, y=-150, z=0
1                         ' ← rotation_len
1.5 0 0 0.000000 1.000000 ' ← rotation: time=1.5, x=0, y=0, z=0.0, w=1.0 (identity)

1658                      ' ← clip_id (auto generated by tool)
1.5                       ' ← duration (seconds)
1                         ' ← translation_len
1.5 0 -150 75             ' ← translation: time=1.5, x=0, y=-150, z=75
1                         ' ← rotation_len
1.5 0 0 0.000000 1.000000 ' ← rotation: time=1.5, x=0, y=0, z=0.0, w=1.0 (identity)

1659                      ' ← clip_id (auto generated by tool)
1.5                       ' ← duration (seconds)
1                         ' ← translation_len
1.5 0 -150 300            ' ← translation: time=1.5, x=0, y=-150, z=300
1                         ' ← rotation_len
1.5 0 0 0.000000 1.000000 ' ← rotation: time=1.5, x=0, y=0, z=0.0, w=1.0 (identity)

1660                      ' ← clip_id (auto generated by tool)
1.5                       ' ← duration (seconds)
1                         ' ← translation_len
1.5 0 -150 -150           ' ← translation: time=1.5, x=0, y=-150, z=-150
1                         ' ← rotation_len
1.5 0 0 0.000000 1.000000 ' ← rotation: time=1.5, x=0, y=0, z=0.0, w=1.0 (identity)
```

---

## RD: Rotation Data

Each rotation line consists of:

time x y z w

For FNIS, the format pattern `RD <time> <delta_z_angle>` exists, and in this case it is automatically converted to a quaternion.

$q = \left( 0, 0, \sin\frac{\theta}{2}, \cos\frac{\theta}{2} \right)$

where θ = delta_z_angle (radians).

- [See Code](https://play.rust-lang.org/?version=stable&mode=debug&edition=2024&gist=a6d54a0bbf504655553e9b1bef84699a)

---

- Example

```vb
' format(2nd patten): time delta_z_angle
RD 1.5 0
RD 1.5 30
RD 1.5 -30
```

- animationdatasinglefile.txt FNIS Output:

```vb
1.5 0 0 0.000000 1.000000  ' ← time=1.5, θ=0 → identity quaternion
1.5 0 0 0.000000 1.000000  ' ← time=1.5, θ=0 → identity quaternion
1.5 0 0 0.258819 0.965926  ' ← time=1.5, θ≈30° → z=sin(15°), w=cos(15°)
1.5 0 0 -0.258819 0.965926 ' ← time=1.5, θ≈-30° → z=sin(-15°), w=cos(-15°)
```
